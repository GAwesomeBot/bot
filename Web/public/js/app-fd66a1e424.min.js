/* GAwesomeBot by Gilbert - Available under the GPL V2 License - Some rights reserved - https://github.com/GilbertGobbels/GAwesomeBot */
const GAwesomeData={},GAwesomeUtil={},GAwesomePaths={};function saveFormState(){try{$("#builder-code-box").val(cm.getDoc().getValue())}catch(e){}initial_form_state=$("#form").serialize(),$("#form-submit span:nth-child(2)").html("Save")}GAwesomeData.activity={guildData:{}},GAwesomeData.blog={editor:{}},GAwesomeData.wiki={bookmarks:JSON.parse(localStorage.getItem("wiki-bookmarks"))||[],editor:{}},GAwesomeData.extensions={},GAwesomeData.dashboard={servers:{}},GAwesomeUtil.dashboard={},GAwesomeData.config={debug:localStorage.getItem("gab:debug")||!1},GAwesomeData.extensions.html={start:{"#installer-title":"Installing $EXTNAME","#installer-subtitle":"Extension Information"},config:{"#global":()=>{GAwesomeData.extensions.state.data.server=GAwesomeData.extensions.servers.find(e=>e.id===$("#installer-serverSelect").val()),$("#installer-selector").hide()},"#installer-continue":()=>'\n\t\t\t\tNext &nbsp;\n\t\t\t\t<span class="icon is-small">\n\t\t\t\t\t<i class="fa fa-arrow-right"></i>\n\t\t\t\t</span>\n\t\t\t',"#installer-subtitle":()=>"Extension Configuration","#installer-content":()=>{let e=`\n\t\t\t\t<div class="box has-text-left">\n\t\t\t\t<h4 class="subtitle is-4">\n\t\t\t\t\tOptions for <strong>${GAwesomeData.extensions.state.extension.name}</strong>\n\t\t\t\t</h4>\n\t\t\t\t`;["keyword","command"].includes(GAwesomeData.extensions.state.extension.type)&&(e+='\n\t\t\t\t<div class="field">\n\t\t\t\t\t<label class="label">Permissions</label>\n\t\t\t\t\t<div class="control">\n\t\t\t\t\t\t<span class="select is-primary">\n\t\t\t\t\t\t\t<select name="installer-adminLevel">\n\t\t\t\t\t\t\t\t<option value="0" selected>@everyone</option>\n\t\t\t\t\t\t\t\t<option value="1">Admin level &ge;1</option>\n\t\t\t\t\t\t\t\t<option value="2">Admin level &ge;2</option>\n\t\t\t\t\t\t\t\t<option value="3">Admin level &ge;3</option>\n\t\t\t\t\t\t\t</select>\n\t\t\t\t\t\t</span>\n\t\t\t\t\t</div>\n\t\t\t\t\t<span class="help">The extension will only respond to members that have the selected bot admin level (or higher).</span>\n\t\t\t\t</div>'),e+='\n\t\t\t\t<div class="field">\n\t\t\t\t\t<label class="label">Channel(s)</label>\n\t\t\t\t',$.get(`/api/servers/${GAwesomeData.extensions.state.data.server.id}/channels`,t=>{Object.values(t).filter(e=>"text"===e.type).sort((e,t)=>e.rawPosition-t.rawPosition).forEach(t=>{e+=`\n\t\t\t\t\t\t<label class="checkbox">\n\t\t\t\t\t\t<input name="installer-disabled_channel_ids-${t.id}" class="installer-disabled_channel_ids" type="checkbox">\n\t\t\t\t\t\t\t#${t.name}\n\t\t\t\t\t\t</label>\n\t\t\t\t\t\t<br>`}),e+='\n\t\t\t\t</div>\n\t\t\t\t<div class="field">\n\t\t\t\t\t<div class="control has-addons">\n\t\t\t\t\t\t<a class="button is-small" onclick="GAwesomeUtil.toggleChannels(\'installer-disabled_channel_ids\', true);">\n\t\t\t\t\t\t\t<span>Select All</span>\n\t\t\t\t\t\t</a>\n\t\t\t\t\t\t<a class="button is-small" onclick="GAwesomeUtil.toggleChannels(\'installer-disabled_channel_ids\', false);">\n\t\t\t\t\t\t\t<span>Deselect All</span>\n\t\t\t\t\t\t</a>\n\t\t\t\t\t</div>\n\t\t\t\t\t<span class="help">The extension will run only in these channels.</span>\n\t\t\t\t</div></div>',$("#installer-content").html(e)})}},confirm:{"#global":()=>{},"#installer-continue":()=>"Install","#installer-subtitle":()=>"Confirmation"}},GAwesomeUtil.reload=(()=>window.location.reload(!0)),GAwesomeUtil.refresh=(()=>Turbolinks.visit("")),GAwesomeUtil.log=((e,t,s)=>{if(GAwesomeData.config.debug||s)return!e||"string"!=typeof e||t&&!["log","warn","error"].includes(t)?console.warn("[GAwesomeBot] [WARN] Invalid Arguments for log()"):void console[t||"log"](`[GAwesomeBot] [${"log"!==t&&t?t.toUpperCase():"DEBUG"}] ${e}`)}),GAwesomeUtil.error=(e=>GAwesomeUtil.log(e,"error",!0)),GAwesomeUtil.warn=(e=>GAwesomeUtil.log(e,"warn",!0)),GAwesomeUtil.debugDump=(()=>{let e;GAwesomeUtil.log("[DUMP:INFO] Pass this information to a GAB Support Member and they will assist you further!","log",!0),GAwesomeData.dashboard.socket&&(e=GAwesomeData.dashboard.socket,GAwesomeData.dashboard.socket={}),GAwesomeUtil.log(`[DUMP:APPDATA] ${JSON.stringify(GAwesomeData)}`,"log",!0),GAwesomeData.dashboard.socket=e,GAwesomeUtil.log(`[DUMP:SESSIONDATA] ${JSON.stringify(localStorage)}`,"log",!0),GAwesomeUtil.log(`[DUMP:LIBDATA] ${JSON.stringify({tl:!!Turbolinks,io:!!io,form:!!submitForm,bulma:!!bulma,np:!!NProgress,fs:!!saveAs,md:!!md5})}`,"log",!0)}),GAwesomeUtil.setUserAutocomplete=(e=>{const t=e=>new autoComplete({selector:".user-autocomplete",minChars:2,source:function(t,s){t=t.toLowerCase(),s(e.filter(function(e){return e.toLowerCase().indexOf(t)>-1}))}}),s=GAwesomeUtil.dashboard.getCache(e,"userlist");if(s)return t(s);$.getJSON("/api/list/users"+(e?"?svrid="+e:""),s=>{t(s),GAwesomeUtil.dashboard.setCache(e,"userlist",s)})}),GAwesomeUtil.updateHeader=(()=>{const e=$("#nav-"+window.location.pathname.split("/")[1]);e&&e.addClass("is-tab")}),GAwesomeUtil.toggleChannels=((e,t)=>{const s=document.getElementsByClassName(e),o=s.length;for(let e=0;e<o;e++)s[e].checked=t}),GAwesomeUtil.switchActivityLayout=(e=>{switch(e?localStorage.setItem("servers-layout",e):(e=localStorage.getItem("servers-layout"))||(localStorage.setItem("servers-layout","grid"),e=localStorage.getItem("servers-layout")),e){case"grid":$("#grid-layout-button").addClass("is-primary"),$("#list-layout").addClass("is-hidden"),$("#grid-layout").removeClass("is-hidden"),$("#list-layout-button").removeClass("is-primary");break;case"list":$("#list-layout-button").addClass("is-primary"),$("#list-layout").removeClass("is-hidden"),$("#grid-layout-button").removeClass("is-primary"),$("#grid-layout").addClass("is-hidden")}}),GAwesomeUtil.activityBanGuild=(e=>{confirm("Are you sure you want to remove this guild from the activity page? It will no longer be visible on this page.")&&$.post("/dashboard/maintainer/servers/server-list",{removeFromActivity:e}).done(()=>{const t=$(`#cardContent-${e}`);GAwesomeData.activity.guildData[e]=t.html(),t.html(`\n\t\t\t\t<a class="has-text-centered is-4" href="javascript:GAwesomeUtil.activityUnbanGuild('${e}')">\n    \t\t\t<span class="icon">\n        \t\t<i class="fa fa-refresh"></i>\n    \t\t\t</span>\n    \t\t\tUndo ban\n\t\t\t\t</a>\n\t\t\t`),t.addClass("has-text-centered")})}),GAwesomeUtil.activityUnbanGuild=(e=>{$.post("/dashboard/maintainer/servers/server-list",{unbanFromActivity:e}).done(()=>{const t=$(`#cardContent-${e}`);t.removeClass("has-text-centered"),t.html(GAwesomeData.activity.guildData[e])})}),GAwesomeUtil.activityViewportUpdate=(e=>{"activity"!==window.location.pathname.split("/")[1]&&"extensions"!==window.location.pathname.split("/")[1]||(e.matches?($(".header-search-box").removeClass("is-large"),document.getElementById("frame").style.paddingLeft="15px",document.getElementById("frame").style.paddingRight="15px","servers"===document.getElementById("search-select").value&&switchLayout("list")):($(".header-search-box").addClass("is-large"),document.getElementById("frame").style.paddingLeft="0px",document.getElementById("frame").style.paddingRight="0px"))}),GAwesomeUtil.uploadContent=((e,t)=>{if(e){const s=new FileReader;s.onload=function(e){GAwesomeData[t].editor.value(e.target.result)},s.readAsText(e[0]),document.getElementById("composer-content-upload").value=null}}),GAwesomeUtil.uploadCode=(e=>{if(e){const t=new FileReader;t.onload=function(e){GAwesomeData.builder.getDoc().setValue(e.target.result)},t.readAsText(e[0]),document.getElementById("builder-code-upload").value=null}}),GAwesomeUtil.downloadContent=(()=>{const e=new Blob([document.getElementById("composer-content").value],{type:"text/markdown;charset=utf-8"});saveAs(e,(document.getElementById("composer-title").value||"Untitled")+".md")}),GAwesomeUtil.downloadCode=(()=>{const e=new Blob([GAwesomeData.builder.getValue()],{type:"text/markdown;charset=utf-8"});saveAs(e,(document.getElementById("builder-title").value||"Untitled")+".gabext")}),GAwesomeUtil.searchWiki=(e=>{Turbolinks.visit("/wiki?q="+encodeURIComponent(e))}),GAwesomeUtil.getBookmarkLink=(e=>window.location.pathname.split("/").slice(-1)[0]+"#"+e),GAwesomeUtil.bookmarkWikiSection=(e=>{const t=GAwesomeUtil.getBookmarkLink(e.parentNode.id);GAwesomeData.wiki.bookmarks.indexOf(t)>-1?GAwesomeData.wiki.bookmarks.splice(GAwesomeData.wiki.bookmarks.indexOf(t),1):GAwesomeData.wiki.bookmarks.push(t),localStorage.setItem("wiki-bookmarks",JSON.stringify(GAwesomeData.wiki.bookmarks)),$(e).toggleClass("is-dark is-text"),GAwesomeUtil.populateWikiBookmarks()}),GAwesomeUtil.populateWikiSections=(()=>{let e="<ul>";const t=document.getElementById("frame").querySelectorAll("h1, h2, h3");for(let s=0;s<t.length;s++)s>0&&"H3"!==t[s].tagName&&t[s-1]&&"H3"===t[s-1].tagName&&(e+="</ul>"),e+="<li>","H3"===t[s].tagName&&(s>0&&t[s-1]&&"H3"!==t[s-1].tagName||0===s)&&(e+="<ul>"),e+="<a class='heading-shortcut-link' href='#"+t[s].id+"' data-turbolinks='false'>"+t[s].innerHTML+"</a></li>",t[s].innerHTML+="&nbsp;<a class='button is-text "+("H3"===t[s].tagName?"is-small":"")+" heading-shortcut-link' style='text-decoration:none;' href='#"+t[s].id+"' data-turbolinks='false'><i class='fa fa-link'></i></a>&nbsp;<a class='button "+(GAwesomeData.wiki.bookmarks.indexOf(GAwesomeUtil.getBookmarkLink(t[s].id))>-1?"is-dark":"is-text")+" "+("H3"===t[s].tagName?"is-small":"")+"' style='text-decoration:none;' onclick='GAwesomeUtil.bookmarkWikiSection(this);'><i class='fa fa-bookmark'></i></a>";e+="</ul>",t[t.length-1]&&"H3"===t[t.length-1].tagName&&(e+="</ul>"),$("#submenu").html(e),$("table").addClass("table"),$(".heading-shortcut-link").click(function(){$("html, body").animate({scrollTop:$("#"+this.href.substring(this.href.lastIndexOf("#")+1)).offset().top},172)})}),GAwesomeUtil.populateWikiBookmarks=(()=>{if(GAwesomeData.wiki.bookmarks.length>0){$("#bookmarks-menu").removeClass("is-hidden"),$("#menu-spacer").removeClass("is-hidden"),GAwesomeData.wiki.bookmarks=GAwesomeData.wiki.bookmarks.sort();let e="<ul>";for(let t=0;t<GAwesomeData.wiki.bookmarks.length;t++)e+="<li><a href='"+GAwesomeData.wiki.bookmarks[t]+"' data-turbolinks='false'>"+decodeURI(GAwesomeData.wiki.bookmarks[t]).replace("#"," &raquo; ")+"</a></li>";e+="</ul>",$("#bookmarks-submenu").html(e)}else $("#bookmarks-menu").addClass("is-hidden"),$("#menu-spacer").addClass("is-hidden")}),GAwesomeUtil.publishExtension=(e=>{confirm("Are you sure you want to publish this extension? Everyone will be able to view and use this extension!")&&(NProgress.start(),$(`#publish-${e}`).remove(),$.ajax({type:"POST",url:`/extensions/${e}/publish`,data:{}}).always(()=>{NProgress.done(),NProgress.remove()}))}),GAwesomeUtil.deleteExtension=(e=>{confirm("Are you sure you want to remove this extension? This action is irreversible!")&&(NProgress.start(),$(`#delete-${e}`).parent().parent().remove(),$.ajax({type:"POST",url:`/extensions/${e}/delete`,data:{}}).always(()=>{NProgress.done(),NProgress.remove()}))}),GAwesomeUtil.saveExtension=((e,t)=>{NProgress.start(),hide_update_modal=!0;const s=$("#form").serializeArray();s.find(e=>"code"===e.name).value=GAwesomeData.builder.getValue(),$.ajax({method:"POST",url:t,data:s}).always(function(t){const s=$("#form-submit");NProgress.done(),NProgress.remove(),saveFormState(),"OK"!==t&&200!==t.status&&302!==t.status?(s.find("span:nth-child(1)").html("<i class='fa fa-exclamation'></i>"),s.find("span:nth-child(2)").html("Error")):e?Turbolinks.visit("/extensions/my"):Turbolinks.visit("")})}),GAwesomeUtil.voteExtension=(e=>{const t=$(`#vote-${e}`),s=t.html().trim();t.html("-1"===s?"+1":"-1"),$.post(`/extensions/${e}/upvote`);const o=$(`#points-${e}`);o.html("-1"===s?Number(o.html())-1:Number(o.html())+1)}),GAwesomeUtil.unpublishExtension=(e=>{if(!confirm("Are you sure you want to unpublish this extension? It will no longer be usable or visible by guilds, points are preserved."))return;NProgress.start();const t=$(`#card-${e}`);$.post(`/extensions/${e}/unpublish`),t.remove(),NProgress.done(),NProgress.remove()}),GAwesomeUtil.rejectExtension=(e=>{let t=prompt("Reason to reject:");t||(t="No reason given."),NProgress.start(),$.ajax({method:"POST",url:`/extensions/${e}/reject`,data:{reason:t}}).done(()=>{$(`#card-${e}`).remove(),NProgress.done(),NProgress.remove()})}),GAwesomeUtil.removeExtension=(e=>{let t=prompt("Reason to remove:");t||(t="No reason given."),NProgress.start(),$.ajax({method:"POST",url:`/extensions/${e}/remove`,data:{reason:t}}).done(()=>{$(`#card-${e}`).remove(),NProgress.done(),NProgress.remove()})}),GAwesomeUtil.acceptExtension=(e=>{NProgress.start(),$.post(`/extensions/${e}/accept`).done(()=>{NProgress.done(),NProgress.remove(),Turbolinks.visit("/extensions/gallery")})}),GAwesomeUtil.featureExtension=(e=>{const t=$(`#feature-${e}`),s="Feature"!==t.html().trim();t.html(s?"Feature":"Unfeature"),$.post(`/extensions/${e}/feature`),$(`#featured-${e}`).html(s?"":'<span class="tag is-primary">Featured</span>&nbsp;')}),GAwesomeUtil.installExtension=(e=>{GAwesomeUtil.log("Beginning Extension installing process");const t=GAwesomeData.extensions.extensions.find(t=>t._id===e);if(!t)return GAwesomeUtil.warn(`Failed to find Extension Data for ID ${e}`);const s=GAwesomeData.extensions.html;GAwesomeUtil.log("Extension Installing Phase: START"),GAwesomeData.extensions.state={phase:0,id:e,extension:t,ongoing:!0,data:{},phases:["start"]},"event"!==t.type&&GAwesomeData.extensions.state.phases.push("config"),t.scopes.length&&GAwesomeData.extensions.state.phases.push("scopes"),t.fields&&t.fields.length&&GAwesomeData.extensions.state.phases.push("fields"),GAwesomeData.extensions.state.phases.push("confirm"),Object.keys(s.start).forEach(e=>$(e).html(s.start[e].replace("$EXTNAME",t.name))),$("html").addClass("is-clipped"),$("#installer-modal").addClass("is-active")}),GAwesomeUtil.cancelInstall=(()=>{GAwesomeData.extensions.state&&GAwesomeData.extensions.state.ongoing?(GAwesomeUtil.log("Stopping Extension install after User Input"),GAwesomeData.extensions.state.ongoing=!1,$("#installer-modal").removeClass("is-active"),$("html").removeClass("is-clipped"),$("#installer-content").html(""),$("#installer-control").css("visibility","hidden"),$("#installer-loading").hide(),$("#installer-progress").attr("value",0),$("#installer-selector").show()):GAwesomeUtil.warn("Extension Install not ongoing!")}),GAwesomeUtil.switchInstallTarget=(()=>{if(!GAwesomeData.extensions.state||!GAwesomeData.extensions.state.ongoing)return GAwesomeUtil.warn("An Install is not ongoing");const e=$("#installer-serverSelect").val(),t=$("#installer-content");if(t.hide(),"select"===e)t.html(""),$("#installer-control").css("visibility","hidden");else{const s=GAwesomeData.extensions.state.extension,o=GAwesomeData.extensions.servers.find(t=>t.id===e);let a=`\n\t\t\t\t\t\t\t\t<br>\n\t\t\t\t\t\t\t\t<h5 class="title is-5">${s.name}</h5>\n\t\t\t\t\t\t\t\t<h5 class="subtitle is-5">$DATA</h5>\n\t\t\t\t\t\t\t\t<span class="icon is-large">\n\t\t\t\t\t\t\t\t\t<i class="fa fa-2x fa-arrow-down"></i>\n\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t<br>\n\t\t\t\t\t\t\t\t<br>\n\t\t\t\t\t\t\t\t<img src="${o.icon}" alt="${o.id}" height="128" width="128">\n\t\t\t\t\t\t\t\t<h5 class="title is-5">${o.name}</h5>\n\t\t\t\t\t\t\t\t`;switch(s.type){case"command":a=a.replace("$DATA",`Use <code>${o.prefix}${s.typeDescription}</code> to trigger this extension.`);break;case"keyword":a=a.replace("$DATA",`Messages with <code>${s.typeDescription}</code> will trigger this extension.`);break;case"timer":a=a.replace("$DATA",`Every <code>${s.typeDescription}</code> this extension will trigger.`);break;case"event":a=a.replace("$DATA",`This extension will trigger on the <code>${s.typeDescription}</code> event.`)}t.html(`${a}`),$("#installer-control").css("visibility","visible")}$("#installer-loading").hide(),t.show()}),GAwesomeUtil.advanceInstall=(()=>{if(GAwesomeData.extensions.state.inUse)return;GAwesomeData.extensions.state.inUse=!0,$("#installer-content").hide(),$("#installer-loading").show();const e=GAwesomeData.extensions.state.phases,t=GAwesomeData.extensions.state.phase+1;$("#installer-progress").attr("value",Math.ceil(t/(e.length-1)*100)),GAwesomeData.extensions.state.phase=t;const s=GAwesomeData.extensions.html;Object.keys(s[e[t]]).forEach(o=>$(o).html(s[e[t]][o]())),$("#installer-loading").hide(),$("#installer-content").show(),GAwesomeData.extensions.state.inUse=!1}),GAwesomePaths.extensions=(()=>{"/extensions/builder"===window.location.pathname&&(setTimeout(function(){saveFormState()},0),GAwesomeData.builder=CodeMirror.fromTextArea(document.getElementById("builder-code-box"),{mode:"javascript",lineWrapping:!0,lineNumbers:!0,fixedGutter:!0,styleActiveLine:!0,theme:"monokai"}),GAwesomeData.builder.refresh())}),GAwesomeUtil.dashboardWrapper=(e=>"dashboard"!==window.location.pathname.split("/")[1]?"This function can only be executed within the dashboard.":e()),GAwesomeUtil.dashboard.connect=(()=>GAwesomeUtil.dashboardWrapper(()=>{GAwesomeData.dashboard.socket&&(GAwesomeUtil.log("Closing stale Dashboard socket"),GAwesomeData.dashboard.socket.close()),GAwesomeUtil.log("Opening new Dashboard socket"),GAwesomeData.dashboard.socket=io(window.location.pathname,{transports:["websocket"]}),GAwesomeData.dashboard.socket.on("update",function(e){GAwesomeUtil.log(`Received Socket data: ${e}`),hide_update_modal||GAwesomeData.dashboard.svrid!==e||"none"===localStorage.getItem("dashboardUpdates")||($("html").addClass("is-clipped"),$("#update-modal").addClass("is-active"))}),GAwesomeData.dashboard.socket.on("logs",e=>{let t=`[${e.timestamp}] [${e.level}] ${e.message}`;GAwesomeData.dashboard.terminal.print(t),$(".Terminal").animate({scrollTop:$(".Terminal").prop("scrollHeight")},500)})})),GAwesomeUtil.dashboard.setCache=((e,t,s,o=300)=>{GAwesomeData.cache||(GAwesomeData.cache=new Map),GAwesomeData.cache.has(e)||GAwesomeData.cache.set(e,new Map),GAwesomeData.cache.get(e).set(t,{data:s,expireAt:Math.floor(Date.now()/1e3)+o})}),GAwesomeUtil.dashboard.getCache=((e,t)=>{if(!GAwesomeData.cache||!GAwesomeData.cache.has(e)||!GAwesomeData.cache.get(e).has(t))return;const s=GAwesomeData.cache.get(e).get(t);if(!(s.expireAt<Math.floor(Date.now()/1e3)))return s.data;GAwesomeData.cache.get(e).delete(t)}),GAwesomeUtil.dashboard.removeElement=(e=>GAwesomeUtil.dashboardWrapper(()=>{const t=$(e);t.addClass("is-loading");const s=t.parents("tr"),o=s.parents("table"),a=s.is(":only-child"),i=t.attr("name");$.ajax({url:`${window.location.pathname}/${i}`,method:"DELETE"}).always(()=>{s.fadeOut(400,()=>{s.remove(),a&&(o.addClass("is-hidden"),$(".no-elements-message").removeClass("is-hidden"))})})})),GAwesomePaths.landing=(()=>{$(".section-shortcut-link").click(function(){$("html, body").animate({scrollTop:$("#"+this.href.substring(this.href.lastIndexOf("#")+1)).offset().top},172)})}),GAwesomePaths.activity=(()=>{GAwesomeUtil.activityViewportUpdate(GAwesomeListeners.activityMQL),"/activity/users"===window.location.pathname?(document.getElementById("search-button").href="javascript:GAwesomeUtil.searchUsers(document.getElementById('search-input').value);",document.getElementById("search-input").onkeydown=function(){13===event.keyCode&&GAwesomeUtil.searchUsers(this.value)},$.getJSON("/api/list/users",function(e){searchInputAutocomplete=new autoComplete({selector:"#search-input",minChars:2,source:function(t,s){t=t.toLowerCase(),s(e.filter(function(e){return e.toLowerCase().indexOf(t)>-1}))}})})):(GAwesomeData.activity.guildData={},document.getElementById("search-button").href="javascript:GAwesomeUtil.searchServers(document.getElementById('search-input').value);",document.getElementById("search-input").setAttribute("list","servers"),document.getElementById("search-input").onkeydown=function(){13===event.keyCode&&GAwesomeUtil.searchServers(this.value)},$.getJSON("/api/list/servers",function(e){searchInputAutocomplete=new autoComplete({selector:"#search-input",minChars:2,source:function(t,s){t=t.toLowerCase(),s(e.filter(function(e){return e.toLowerCase().indexOf(t)>-1}))}})}),GAwesomeUtil.switchActivityLayout(),GAwesomeUtil.showActivitySelections())}),GAwesomePaths.blog=(()=>{if(setTimeout(function(){saveFormState()},0),!window.location.toString().endsWith("/compose")&&!window.location.toString().endsWith("/new"))return;const e=new showdown.Converter({tables:!0,simplifiedAutoLink:!0,strikethrough:!0,tasklists:!0,smoothLivePreview:!0,smartIndentationFix:!0});GAwesomeData.blog.editor=new SimpleMDE({element:document.getElementById("composer-content"),forceSync:!0,spellChecker:!1,promptURLs:!0,previewRender:function(t){return $(".editor-preview").addClass("content"),$(".editor-preview-side").addClass("content"),e.makeHtml(t)}})}),GAwesomePaths.wiki=(()=>{if(setTimeout(function(){saveFormState()},0),GAwesomeData.wiki.bookmarks=JSON.parse(localStorage.getItem("wiki-bookmarks"))||[],GAwesomeUtil.populateWikiBookmarks(),!window.location.toString().endsWith("/edit")&&!window.location.toString().endsWith("/new"))return;const e=new showdown.Converter({tables:!0,simplifiedAutoLink:!0,strikethrough:!0,tasklists:!0,smoothLivePreview:!0,smartIndentationFix:!0});GAwesomeData.wiki.editor=new SimpleMDE({element:document.getElementById("composer-content"),forceSync:!0,spellChecker:!1,promptURLs:!0,previewRender:function(t){return $(".editor-preview").addClass("content"),$(".editor-preview-side").addClass("content"),e.makeHtml(t)}})}),GAwesomePaths.dashboard=(()=>GAwesomeUtil.dashboardWrapper(()=>{$(".close-update-modal").unbind(),$(".close-update-modal").click(()=>{$("html").removeClass("is-clipped"),$("#update-modal").removeClass("is-active")}),GAwesomeUtil.dashboard.connect();window.location.pathname.split("/")[3];const e=window.location.pathname.split("/")[4];if("command-options"===e)$("#ban_gif").on("blur",()=>{if("Default"===$("#ban_gif").val())return $("#default_ban_gif").hide(),$("#ban_gif_field").removeClass("has-addons"),$("#ban_gif_preview").attr("src","https://imgur.com/3QPLumg.gif");$("#ban_gif_field").addClass("has-addons"),$("#default_ban_gif").show(),$("#ban_gif_preview").attr("src",$("#ban_gif").val())});else if("name-display"===e){const e=$("#currentExample"),t=$("#name_display-use_nick"),s=$("#name_display-show_discriminator");t.click(()=>{t.is(":checked")&&""!==GAwesomeData.nickname?e.text(GAwesomeData.nickname):e.text(GAwesomeData.username),s.is(":checked")&&e.text(`${e.text().trim()}#${GAwesomeData.discriminator}`)}),s.click(()=>{s.is(":checked")?e.text(e.text()+`#${GAwesomeData.discriminator}`):e.text(e.text().trim().slice(0,-5))})}})),document.addEventListener("turbolinks:load",()=>{try{GAwesomeUtil.log("Start load page JS"),GAwesomeUtil.updateHeader(),bulma(),hide_update_modal=!1,initial_form_state=$("#form").serialize(),GAwesomeData.dashboard.socket&&(GAwesomeUtil.log("Closing stale Dashboard socket"),GAwesomeData.dashboard.socket.close(),delete GAwesomeData.dashboard.socket),GAwesomeData.section=window.location.pathname.split("/")[1];let e=GAwesomePaths[GAwesomeData.section];""===GAwesomeData.section&&(e=GAwesomePaths.landing),e&&e(),NProgress.done(),GAwesomeUtil.log(`Finished loading page using ${""!==GAwesomeData.section?GAwesomeData.section:"landing"} section handler`)}catch(e){NProgress.done(),NProgress.remove(),GAwesomeUtil.error(`An exception occurred while trying to prepare ${location.pathname}: ${e}`),swal("An exception occurred.",e.toString(),"error")}});const GAwesomeListeners={};GAwesomeListeners.activityMQL=window.matchMedia("screen and (max-width: 768px)"),GAwesomeListeners.activityMQL.addListener(GAwesomeUtil.activityViewPortUpdate),$(window).scroll(function(){$("#form-buttons")&&$("#form-buttons").is(":visible")?$("#scroll-top-button-container").css("padding-bottom","75px"):$("#scroll-top-button-container").css("padding-bottom","25px"),$(this).scrollTop()>200&&$(this).scrollTop()<$(document).height()-1200?$("#scroll-top-button-container").fadeIn(86):$("#scroll-top-button-container").fadeOut(86)}),$(document).on("turbolinks:click",function(){window.location.pathname.startsWith("/dashboard")?NProgress.configure({parent:"section.section.is-white"}):NProgress.configure({parent:"body"}),NProgress.start()}),String.prototype.replaceAll=function(e,t){return this.replace(new RegExp(e,"g"),t)};let keys=[];const konami="38,38,40,40,37,39,37,39,66,65",dolphin="68,69,76,73,71,72,84,69,68,32,68,79,76,80,72,73,78",unknown="38c972419c82c3059933ecefee492ad2";window.addEventListener("keydown",function(e){16!==e.keyCode&&keys.push(e.keyCode),keys.toString().includes(konami)&&(keys=[],document.body.innerHTML=document.body.innerHTML.replace(/GAwesomeBot/g,"TacoBot"),document.body.innerHTML=document.body.innerHTML.split("/static/img/icon.png").join("/static/img/tinytaco.png"),document.getElementById("header").style.backgroundImage="url('/static/img/header-bg-taco.jpg')"),keys.toString().includes(dolphin)&&(keys=[],$("*").contents().filter(function(){return this.nodeType===Node.TEXT_NODE&&""!==this.nodeValue.trim()}).each(function(){let e="";for(let t=0;t<this.nodeValue.length;t++)e+="ðŸ¬";this.nodeValue=e})),md5(keys.toString())===unknown&&(keys=[],document.body.innerHTML=document.body.innerHTML.split("/GilbertGobbels/GAwesomeBot").join("/BitQuote/AwesomeBot"),document.body.innerHTML=document.body.innerHTML.replace(/GAwesomeBot/g,"AwesomeBot Neo"),document.body.innerHTML=document.body.innerHTML.split("/static/img/icon.png").join("/static/img/NEO.png"),$("#footerText").html('<strong>AwesomeBot NEO</strong> by BitQuote & <a href="https://github.com/BitQuote">BitQuote</a>. Made with <a href="https://github.com/BitQuote">BitQuote</a> and <a href="https://github.com/BitQuote">BitQuote</a>. Site made with <a href="https://github.com/BitQuote">BitQuote</a> and <a href="https://github.com/BitQuote">BitQuote</a>. Artwork by <a href="https://github.com/BitQuote">BitQuote</a> and <a href="https://github.com/BitQuote">BitQuote</a>. All rights reserved by BitQuote.'),$(".developer-card-name").html("BitQuote").attr("ondblclick",""),$(".developer-card-icon").attr("src","/static/img/bitquote.png"),$(".developer-card-role").html("(Evil) Creator, Bot Killer"))},!0);
